<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cafeteria">

	<select id="loginCheck" resultType="String">
		select * from tb_00_member
		where USER_ID = #{userId}
		and ADMIN_PW = #{adminPw}
	</select>
	<select id="memberInfo" resultType="com.school.web.vo.SchoolVO">
		select
		MEMBER_NAME as memberName,
		USER_ID as userId
		from tb_00_member
		where USER_ID = #{userId} and ADMIN_PW = #{adminPw}
	</select>
	<select id="researchList" resultType="com.school.web.vo.RSVO">
  <![CDATA[
    Select SUR_SEQ as surSeq, SUR_TITLE as surTitle, SUR_SAT_DATE as surSatDate, SUR_END_DATE as surEndDate, CASE WHEN sur_end_date < to_char(sysdate, 'yyyymmdd') THEN '완료'
       ELSE '진행중' END AS surIsend FROM TB_06_RS order BY SUR_SEQ desc
  ]]>
	</select>
	
	<insert id="researchRSI">
		insert into TB_06_RSI 
		(
			SURI_SEQ,
			SUR_SEQ,
			SURQ_SEQ,
			SUR_TITLE,
			QUE_CNT,
			SUR_SAT_DATE,
			SUR_END_DATE,
			ATTACH_NAME,
			ATTACH_PATH,
			SURI_TITLE1,
			SURI_TITLE2,
			SURI_TITLE3,
			SURI_TITLE4,
			SURI_TITLE5,
			SURI_TITLE6,
			WRITER,
			REG_NAME,
			REG_DATE,
			UDT_NAME,
			UDT_DATE,
			SURI_NUM1,
			SURI_NUM2,
			SURI_NUM3,
			SURI_NUM4,
			SURI_NUM5
		) values (
			(SELECT NVL(MAX(to_number(SURI_SEQ)+1),1)FROM TB_06_RSI),
			(SELECT NVL(MAX(SUR_SEQ),1)FROM TB_06_RS),
			(SELECT NVL(MAX(SURQ_SEQ),1)FROM TB_06_RSQ),
			#{surTitle},
			#{queCnt},
			#{surSatDate}, 
			#{surEndDate},
			'name',
			#{attachPath},
			#{suriTitle1},
			#{suriTitle2},
			#{suriTitle3},
			#{suriTitle4},
			#{suriTitle5},
			#{suriTitle6},
			#{writer}, #{regName}, sysdate, #{udtName}, sysdate
			,'1','2','3','4','5'
		)
	</insert>

</mapper> 
